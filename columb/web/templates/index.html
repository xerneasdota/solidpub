<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance Trading Analysis System</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header" id="header-panel">
            <div class="panel-content">
                <span class="bold white">Binance Trading Analysis System</span> - Timeframe: <span class="bold green" id="current-timeframe">1h</span>
                <div class="view-toggle-container">
                    <span>View Mode:</span>
                    <button class="view-toggle-button active" id="normal-view-btn">Normal</button>
                    <button class="view-toggle-button" id="slot-machine-view-btn">Slot Machine</button>
                    
                    <span style="margin-left: 15px;" id="algorithm-container" class="hidden">Match Algorithm:</span>
                    <button class="view-toggle-button active hidden" id="consistent-algo-btn">Consistent Top</button>
                    <button class="view-toggle-button hidden" id="momentum-algo-btn">Momentum</button>
                </div>
            </div>
        </div>
        <div class="main">
            <div class="table-container" id="main-table">
                <div class="loading-message">Loading data...</div>
            </div>
            <div class="opportunities-container" id="opportunities-panel">
                <div class="panel-title">Trading Opportunities</div>
                <div class="loading-message">Loading opportunities...</div>
            </div>
            <div id="backtest-panel" class="opportunities-container hidden">
                <div class="panel-title">Backtest Results</div>
                <div class="loading-message">No backtest results</div>
            </div>
        </div>
        <div class="footer" id="footer-panel">
            <div class="panel-content">
                <span class="bold">Commands:</span> 
                <span class="cyan">q</span>:Quit | 
                <span class="cyan">r</span>:Refresh | 
                <span class="cyan">t</span>:Change Timeframe | 
                <span class="cyan">s</span>:Sort By | 
                <span class="cyan">m</span>:Toggle View Mode | 
                <span class="cyan">w</span>:Toggle WebSocket | 
                <span class="cyan">o</span>:Toggle History | 
                <span class="cyan">b</span>:Run Backtest
                | Sorting by: <span class="bold" id="current-sort">overall_rank</span> (<span id="sort-direction">↑</span>)
                | View: <span class="bold" id="current-view">normal</span>
                | WebSocket: <span class="bold green" id="websocket-status">Active</span>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="timeframe-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Select Timeframe</h2>
            <div id="timeframe-options">
                <button class="option-button" data-timeframe="1m">1m</button>
                <button class="option-button" data-timeframe="5m">5m</button>
                <button class="option-button" data-timeframe="15m">15m</button>
                <button class="option-button selected" data-timeframe="1h">1h</button>
                <button class="option-button" data-timeframe="4h">4h</button>
                <button class="option-button" data-timeframe="1d">1d</button>
            </div>
        </div>
    </div>
    
    <div id="sort-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Select Sort Column</h2>
            <div id="sort-options">
                <button class="option-button selected" data-sort="overall_rank">Overall Rank</button>
                <button class="option-button" data-sort="volume_metric">Volume Metric</button>
                <button class="option-button" data-sort="momentum_metric">Momentum Metric</button>
                <button class="option-button" data-sort="price_metric">Price Metric</button>
                <button class="option-button" data-sort="total_pct_change">Total % Change</button>
                <button class="option-button" data-sort="zscore_metric">Z-Score Metric</button>
            </div>
            <div class="sort-direction">
                <h3>Sort Direction</h3>
                <button id="sort-asc" class="control-button selected">Ascending (↑)</button>
                <button id="sort-desc" class="control-button">Descending (↓)</button>
            </div>
        </div>
    </div>

    <div id="backtest-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Run Backtest</h2>
            <div class="form-group">
                <label for="backtest-symbols">Symbols (comma-separated, empty for all):</label>
                <input type="text" id="backtest-symbols" placeholder="BTCUSDT,ETHUSDT,BNBUSDT">
            </div>
            <div class="form-group">
                <label for="backtest-timeframe">Timeframe:</label>
                <select id="backtest-timeframe">
                    <option value="1m">1m</option>
                    <option value="5m">5m</option>
                    <option value="15m">15m</option>
                    <option value="1h" selected>1h</option>
                    <option value="4h">4h</option>
                    <option value="1d">1d</option>
                </select>
            </div>
            <div class="form-group">
                <label for="backtest-take-profit">Take Profit (%):</label>
                <input type="number" id="backtest-take-profit" value="3.0" step="0.1" min="0.1">
            </div>
            <div class="form-group">
                <label for="backtest-stop-loss">Stop Loss (%):</label>
                <input type="number" id="backtest-stop-loss" value="1.5" step="0.1" min="0.1">
            </div>
            <div class="form-group">
                <label for="backtest-max-bars">Max Bars:</label>
                <input type="number" id="backtest-max-bars" value="20" step="1" min="1">
            </div>
            <div class="form-actions">
                <button id="run-backtest-btn" class="control-button">Run Backtest</button>
            </div>
        </div>
    </div>

    <!-- Loading indicator -->
    <div class="loading" id="loading-indicator">
        <div class="loading-content">
            <div class="spinner"></div>
            <div id="loading-text">Loading data...</div>
        </div>
    </div>

    <!-- Status message -->
    <div class="status" id="status-message"></div>
    
    <script src="/static/script.js"></script>
</body>
</html>
